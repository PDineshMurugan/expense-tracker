<ion-content [fullscreen]="true" class="auto-transactions-content">
  <div class="header-simple">
    <ion-buttons>
      <ion-back-button defaultHref="/tabs/dashboard" class="custom-back-btn"></ion-back-button>
    </ion-buttons>
    <h2>Auto-Detected ({{ smsService.getValidSmsCount() }})</h2>
    <div style="width: 48px;"></div>
  </div>

  <div class="page-container animate-fade-in">
    
    <!-- Senders Horizontal Scroll -->
    <section class="section pt-3">
      <h2 class="section-title">By Bank / Sender</h2>
      <div class="horizontal-scroll hide-scrollbar">
        @for (sender of senderSummary(); track sender.name; let i = $index) {
          <div class="glass-card sender-card animate-fade-in-up" 
               [style.animation-delay]="(i * 50) + 'ms'"
               (click)="goToSender(sender.name)">
            <div class="sender-card__top">
              <div class="sender-card__icon" [style.color]="sender.ui.color" [style.backgroundColor]="sender.ui.color + '20'">
                <ion-icon [name]="sender.ui.icon"></ion-icon>
              </div>
              <span class="sender-card__name">{{ sender.name }}</span>
            </div>
            <div class="sender-card__bottom">
              <span class="sender-card__amount">{{ sender.total | currency }}</span>
              <span class="sender-card__count">{{ sender.count }} transactions</span>
            </div>
          </div>
        }
        @if (senderSummary().length === 0) {
          <p class="empty-text">No senders found.</p>
        }
      </div>
    </section>

    <!-- Top Merchants List -->
    <section class="section">
      <h2 class="section-title">Top Merchants</h2>
      <div class="merchant-list stagger-children">
        @for (merchant of topMerchants().slice(0, 15); track merchant.originalName) {
          <div class="glass-card merchant-row" (click)="goToMerchant(merchant.originalName)">
            <div class="merchant-icon-wrap">
              <ion-icon name="card-outline"></ion-icon>
            </div>
            <div class="merchant-info">
              <span class="merchant-name">{{ merchant.originalName }}</span>
              <span class="merchant-count">{{ merchant.count }} transactions</span>
            </div>
            <div class="merchant-total">
              <span class="merchant-amount">{{ merchant.total | currency }}</span>
              <ion-icon name="arrow-forward-outline" class="merchant-arrow"></ion-icon>
            </div>
          </div>
        }
        @if (topMerchants().length === 0) {
          <p class="empty-text">No merchants detected.</p>
        }
      </div>
    </section>

  </div>
</ion-content>